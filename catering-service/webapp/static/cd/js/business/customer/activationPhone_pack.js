/*
 * Compressed by JSA(www.xidea.org)
 */
var checkPhoneCheck=null;$(function(){$("button[name='btnSendPhone']").click(function(){$.ajax({type:"POST",url:_context+"/customerController.do?method=sendActivationPhoneCode2",dataType:"json",success:function(A){var _=msg.result;if(_==0){$("button[name='btnSendPhone']").attr("disabled",true);reciprocalSend2("button[name='btnSendPhone']",60)}else if(_==-1)location.href="loginRegister.jsp";else if(_==1)alert("\u672a\u627e\u5230\u7528\u6237");else alert("\u7cfb\u7edf\u6b63\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}})});$("input[name='btnSendPhone']").click(function(){$.ajax({type:"POST",url:"customerController.do",data:"method=sendActivationPhoneCode",cache:false,dataType:"json",success:function(A){var _=A.result;if(_==0){$("input[name='btnSendPhone']").attr("disabled",true);reciprocalSend("input[name='btnSendPhone']",60)}else if(_==-1)location.href="loginRegister.jsp";else if(_==1)alert("\u672a\u627e\u5230\u7528\u6237");else alert("\u7cfb\u7edf\u6b63\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}})});$(document).click(function(){$(".editPhoneLayout").slideUp("fast")});$(".editPhoneLayout").click(function($){cancelEvent($)});$("input[name='newPhoneNumber']").focus(function(){if($.trim($(this).val())=="\u624b\u673a\u53f7\u7801\u65e0\u6548"||$.trim($(this).val())=="\u8be5\u53f7\u7801\u5df2\u88ab\u5360\u7528"||$.trim($(this).val())=="\u672a\u627e\u5230\u987e\u5ba2"||$.trim($(this).val())=="\u8ddf\u539f\u53f7\u7801\u4e00\u6837")$("input[name='newPhoneNumber']").val("")});checkPhoneCheck=function(){if($.trim($("input[name='phoneCheckCode']").val())==""){$(".errTips:eq(1)").find("span").html("\u8bf7\u586b\u5199\u6821\u9a8c\u7801");$(".errTips:eq(1)").addClass("err");return false}else{$(".errTips:eq(1)").find("span").html("");$(".errTips:eq(1)").removeClass("err");return true}};$("input[name='phoneCheckCode']").blur(function(){checkPhoneCheck()});$("input[name='chkCode']").blur(function(){checkCheckCode()})});goactive=function(){var _=checkPhoneCheck();if(!_)return null;$.ajax({type:"POST",url:"customerController.do",data:"method=activationPhone&phoneCheckCode="+$("input[name='phoneCheckCode']").val(),cache:false,dataType:"json",success:function(A){var _=A.result;if(_==0){alert("\u60a8\u6b63\u5f0f\u6210\u4e3a\u6b63\u5f0f\u7528\u6237");$("form:eq(0)").attr("action",_context+"/customerController-loadCustomerAccountPage.html");$("form:eq(0)").attr("method","post");$("form:eq(0)").submit()}else if(_==-1){$("form:eq(0)").attr("action",_context+"/custcentercontroller-login.html");$("form:eq(0)").attr("target","userlogin");$("form:eq(0)").submit()}else if(_==1){$(".errTips:eq(0)").html("\u8bf7\u70b9\u51fb\u201c\u63a5\u6536\u9a8c\u8bc1\u7801\u6309\u94ae\uff0c\u63a5\u6536\u9a8c\u8bc1\u7801\u201d");$(".errTips:eq(0)").addClass("err")}else if(_==3){$(".errTips:eq(1)").find("span").html("\u6821\u9a8c\u7801\u6821\u9a8c\u5931\u8d25");$(".errTips:eq(1)").addClass("err")}else if(_==4){$(".errTips:eq(0)").html("\u987e\u5ba2\u4e0d\u5b58\u5728");$(".errTips:eq(0)").addClass("err")}else{$(".errTips:eq(0)").html("\u7cfb\u7edf\u6b63\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");$(".errTips:eq(0)").addClass("err")}}})};function checkLoginForm(A){var _=checkPhoneCheck();if(!_)return false;$.ajax({type:"POST",url:"customerController.do",data:"method=activationPhone&phoneCheckCode="+$("input[name='phoneCheckCode']").val(),cache:false,dataType:"json",success:function(A){var _=A.result;if(_==0){alert("\u60a8\u5df2\u6210\u4e3a\u6b63\u5f0f\u7528\u6237");common();$("#activePhonedialog").dialog("close");return false}else if(_==-1)location.href="loginRegister.jsp";else if(_==1){$(".errTips:eq(0)").html("\u8bf7\u70b9\u51fb\u201c\u63a5\u6536\u9a8c\u8bc1\u7801\u6309\u94ae\uff0c\u63a5\u6536\u9a8c\u8bc1\u7801\u201d");$(".errTips:eq(0)").addClass("err")}else if(_==3){$(".errTips:eq(1)").find("span").html("\u6821\u9a8c\u7801\u6821\u9a8c\u5931\u8d25");$(".errTips:eq(1)").addClass("err")}else if(_==4){$(".errTips:eq(0)").html("\u987e\u5ba2\u4e0d\u5b58\u5728");$(".errTips:eq(0)").addClass("err")}else{$(".errTips:eq(0)").html("\u7cfb\u7edf\u6b63\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");$(".errTips:eq(0)").addClass("err")}}});return false}function showEditPhoneLayout(_,B){if($(".editPhoneLayout:visible").size()>0)$(".editPhoneLayout").slideUp("fast");else{var A=$(".currentPhone span").html();$("input[name='newPhoneNumber']").val(A);$(".editPhoneLayout").slideDown("fast",function(){$("input[name='newPhoneNumber']").focus();$("input[name='newPhoneNumber']").select()})}cancelEvent(_)}function saveNewPhone(A){var _=$.trim($("input[name='newPhoneNumber']").val());if($.trim(_)=="")$(".editPhoneLayout").slideUp("fast");else{if(!new RegExp(/^[1][3,4,5,8][0-9]{9}$/).test(_)){$("input[name='newPhoneNumber']").val("\u624b\u673a\u53f7\u7801\u65e0\u6548");return}if(_==$.trim($(".currentPhone span").html())){$("input[name='newPhoneNumber']").val("\u8ddf\u539f\u53f7\u7801\u4e00\u6837");return}$.ajax({type:"POST",url:"customerController.do",data:"method=editCustomerPhone&phone="+_,cache:false,dataType:"json",success:function(A){if(A.result==0){$(".currentPhone span").html(_);$(".editPhoneLayout").slideUp("fast")}else if(A.result==-1)location.href="loginRegister.jsp";else if(A.result==1)$("input[name='newPhoneNumber']").val("\u8be5\u53f7\u7801\u5df2\u88ab\u5360\u7528");else if(A.result==2)$("input[name='newPhoneNumber']").val("\u672a\u627e\u5230\u987e\u5ba2")}})}}function cancelEvent(_){var $=window.event?window.event:_;if(window.event)$.cancelBubble=true;else $.stopPropagation()}function reciprocalSend(A,_){if(_>0){$(A).val("\u91cd\u53d1\u6821\u9a8c\u7801["+_+"]");window.setTimeout("stepSubtract(\""+A+"\","+_+")",1000)}else{$(A).val("\u91cd\u53d1\u6821\u9a8c\u7801");$(A).attr("disabled",false)}}function reciprocalSend2(A,_){if(_>0){$(A).text("\u91cd\u53d1\u6821\u9a8c\u7801["+_+"]");window.setTimeout("stepSubtract2(\""+A+"\","+_+")",1000)}else{$(A).text("\u91cd\u53d1\u6821\u9a8c\u7801");$(A).attr("disabled",false)}}function stepSubtract2(_,$){--$;reciprocalSend2(_,$)}function stepSubtract(_,$){--$;reciprocalSend(_,$)}